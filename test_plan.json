{
  "nodes": [
    {
      "id": "filter_step",
      "op": "filter",
      "params": {
        "column": "pipeline_name",
        "op": "=",
        "value": "ANR Pipeline Company"
      },
      "engine": "polars"
    },
    {
      "id": "agg_step", 
      "op": "aggregate",
      "params": {
        "groupby": ["state_abb"],
        "metrics": [
          {"col": "scheduled_quantity", "fn": "sum"}
        ]
      },
      "engine": "polars"
    },
    {
      "id": "limit_step",
      "op": "limit", 
      "params": {
        "n": 5
      },
      "engine": "polars"
    }
  ],
  "edges": [
    {"src": "raw", "dst": "filter_step"},
    {"src": "filter_step", "dst": "agg_step"}, 
    {"src": "agg_step", "dst": "limit_step"}
  ],
  "inputs": ["raw"],
  "outputs": ["limit_step"]
}
