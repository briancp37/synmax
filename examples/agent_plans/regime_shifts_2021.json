{
  "nodes": [
    {
      "id": "f",
      "op": "filter",
      "params": {
        "column": "eff_gas_day",
        "op": "between", 
        "value": ["2022-01-01", "2022-12-31"]
      }
    },
    {
      "id": "a",
      "op": "aggregate",
      "params": {
        "groupby": ["pipeline_name", "eff_gas_day"],
        "metrics": [
          {
            "col": "scheduled_quantity",
            "fn": "sum"
          }
        ]
      }
    },
    {
      "id": "s",
      "op": "stl_deseasonalize",
      "params": {
        "column": "sum_scheduled_quantity"
      }
    },
    {
      "id": "c",
      "op": "changepoint",
      "params": {
        "column": "deseasonalized",
        "method": "pelt",
        "min_size": 7,
        "penalty": 1.0,
        "min_confidence": 0.1,
        "groupby": ["pipeline_name"]
      }
    },
    {
      "id": "r",
      "op": "rank",
      "params": {
        "by": ["change_magnitude"],
        "descending": true
      }
    },
    {
      "id": "l",
      "op": "limit",
      "params": {
        "n": 10
      }
    },
    {
      "id": "e",
      "op": "evidence_collect",
      "params": {}
    }
  ],
  "edges": [
    {"src": "raw", "dst": "f"},
    {"src": "f", "dst": "a"},
    {"src": "a", "dst": "s"},
    {"src": "s", "dst": "c"},
    {"src": "c", "dst": "r"},
    {"src": "r", "dst": "l"},
    {"src": "l", "dst": "e"}
  ],
  "inputs": ["raw"],
  "outputs": ["l"]
}
